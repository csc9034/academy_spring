<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.mis.mapper.BoardMapper">

<!-- tbl_board 테이블 등록 쿼리 -->
	<insert id="create" parameterType="com.mis.domain.BoardVO">
	INSERT INTO tbl_board b ( b.bno
							, b.title
							, b.content
							, b.writer )
	VALUES ( seq_board.nextval
		  , #{title}
		  , #{content}
		  , #{writer} ) 
	
	</insert>

<!-- tbl_board 테이블 1건의 데이터 조회 쿼리 -->
	<select id="read" parameterType="int" resultType="com.mis.domain.BoardVO">
		SELECT b.bno
			 , b.title
			 , b.content
			 , b.writer
			 , b.regdate
			 , b.viewcnt
		  FROM tbl_board b
		 WHERE b.bno = #{bno}
	</select>

<!-- tbl_board 테이블 1건의 데이터 수정 쿼리 -->
	<update id="update" parameterType="com.mis.domain.BoardVO">
		UPDATE tbl_board b
	     <set>
			<if test="title != null">
				 b.title = #{title}
			</if>
			<if test="content != null">
				, b.content = #{content}
			</if>
			<if test="writer != null">
				, b.writer = #{writer}
			</if>
			<trim prefix="SET" prefixOverrides="," />
			WHERE b.bno = #{bno}
		</set>
	</update> 

<!-- tbl_board 테이블 1건의 데이터 삭제 쿼리 -->
	<delete id="delete" parameterType="com.mis.domain.BoardVO">
		DELETE FROM tbl_board b
	   	 WHERE b.bno = #{bno} 
	</delete>

<!-- tbl_board 테이블 데이터 전체 조회 쿼리 -->
	<select id="listAll" resultType="com.mis.domain.BoardVO">
		<![CDATA[
		SELECT b.bno
			 , b.title
			 , b.content
			 , b.writer
			 , b.regdate
			 , b.viewcnt
		  FROM tbl_board b
		 WHERE b.bno > 0
		 ORDER BY bno DESC, regdate DESC
		]]>
	</select>	
	
	<!-- tbl_board 테이블 viewcnt(조회수)를 수정하는 쿼리 -->
	<update id="updateView" parameterType="com.mis.domain.BoardVO">
		UPDATE tbl_board b
		   SET viewcnt = viewcnt + 1
	     WHERE b.bno = #{bno}
	</update> 
</mapper>